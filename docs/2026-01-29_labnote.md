# CCR8–Envafolimab CDR3 설계 실험 기록

## 1. 실험 개요

- 일자: 2026-01-28
- 담당자: 윤현주
- 프로젝트: CCR8 상부(ECL 및 상부 TM)를 타겟으로 하는 Envafolimab 기반 나노바디 설계
- 목적:
    - CCR8 리간드 결합 포켓 상부를 차폐(blocking)하는 Envafolimab 유래 나노바디를 설계.
    - Envafolimab CDR-H3 구간을 구조·서열 재설계를 통해 CCR8 ECL 상부 포켓을 충전하는 형태로 최적화.


## 2. 사용 데이터 및 구조 정보

### 2.1 CCR8 수용체

- PDB ID: 8TLM (CCR8–Gi 복합체 구조)
- 사용 체인: CCR8 체인 C
- 본 실험에서 사용한 상부 도메인(ECL-only) PDB:
    - 파일 경로: `data/reference/ccr8_ecl_only.pdb`
    - 포함 residue (체인 C 기준):
        - 80–227
        - 237–265
        - 273–314
    - 제거한 영역: ICL 전반, 하부 TM, Helix 8 등 세포질 측 영역.


### 2.2 Envafolimab VHH (나노바디)

- 출처: Envafolimab VHH Alphafold 예측 모델 (로컬에서 mmCIF → PyMOL로 PDB 변환 후 사용). [etloveguitar.tistory](https://etloveguitar.tistory.com/20)
- 파일 경로: `data/reference/envafolimab_vhh.pdb` (PyMOL export 후 정리본 사용).
- 체인 및 residue 정의 (PyMOL에서 확인):
    - 전체 VHH 길이: residue 1–128
    - IMGT 기준 CDR-H3 (CDR3) 구간: residue 98–117
    - 본 실험에서 체인 기호는 D 체인으로 설정.


### 2.3 복합체 입력 PDB

- 목적: CCR8 상부(ECL-only)와 Envafolimab VHH를 포함하는 복합체를 RFdiffusion 입력으로 사용.
- 최종 파일: `data/reference/ccr8_ecl_envafolimab.pdb`
- 체인 구성:
    - 체인 C: CCR8 ECL-only (`ccr8_ecl_only.pdb`)
    - 체인 D: Envafolimab VHH (residue 1–128, CDR-H3 = 98–117)


## 3. 구조 전처리 및 PDB 생성 절차

### 3.1 CCR8 상부 도메인 추출

- 원본 구조: `data/reference/8TLM.pdb`
- 수행 목적: RFdiffusion에 상부 도메인만 입력하여 계산 효율 및 타겟 포켓 명확화.
- 처리 방법(요약):
    - 체인 C 중 residue 80–227, 237–265, 273–314만 남기고 나머지 제거.
    - ICL/하부 TM/Helix 8 영역 삭제 후 `TER`, `END` 레코드 추가.

예시 명령(레시피용):

```bash
cd ~/hj/ccr8_project

grep '^ATOM' data/reference/8TLM.pdb \\
 | awk '$5=="C" && $6>=80 && $6<=227 || $5=="C" && $6>=237 && $6<=265 || $5=="C" && $6>=273 && $6<=314' \\
 > data/reference/ccr8_ecl_only.pdb
echo "TER" >> data/reference/ccr8_ecl_only.pdb
echo "END" >> data/reference/ccr8_ecl_only.pdb
```


### 3.2 Envafolimab VHH 체인 및 번호 정리

- 목적: RFdiffusion 입력에서 일관된 체인명(D)과 residue index를 사용하기 위함.
- 처리 개요:
    - PyMOL에서 불필요한 이종분자 제거 및 단일 체인으로 정리 후 PDB export.
    - Bash/awk를 사용하여 체인명을 D로 통일한 파일(`envafolimab_vhh_D.pdb`) 생성.

예시 명령:

```bash
awk 'substr($1,1,4)=="ATOM"{
  printf("%-6s%5d %-4s%1s%-3s %1s%4d    %8.3f%8.3f%8.3f %5.2f %6.2f           %2s\\n",
         "ATOM",NR,$3,"",$4,"D",$6,$7,$8,$9,$10,$11,$12); next}1' \\
  data/reference/envafolimab_vhh_clean.pdb \\
  > data/reference/envafolimab_vhh_D.pdb
```


### 3.3 CCR8–Envafolimab 복합체 생성

- 목적: RFdiffusion binder design 모드 입력으로 사용할 복합체 PDB 생성.
- 처리: CCR8 ECL-only(PDB)와 Envafolimab VHH(PDB)를 단순 병합 후 `TER`, `END` 추가.

```bash
cat data/reference/ccr8_ecl_only.pdb data/reference/envafolimab_vhh_D.pdb \\
  > data/reference/ccr8_ecl_envafolimab.pdb
echo "TER" >> data/reference/ccr8_ecl_envafolimab.pdb
echo "END" >> data/reference/ccr8_ecl_envafolimab.pdb
```


## 4. RFdiffusion 설정 및 실행 내역

### 4.1 공통 설정

- 모델 모드: protein–protein binder design (SelfConditioning)
- 입력 PDB: `data/reference/ccr8_ecl_envafolimab.pdb`
- 출력 경로 prefix: `data/processed/envaf_ccr8_cdr3`
- 설계 개수: 시범 런 3개 (`inference.num_designs=3`)


### 4.2 Contig 및 마스킹 설정

- receptor (CCR8, 체인 C) contig:
    - `C80-227/C237-265/C273-314`
    - 하나의 연속된 receptor 체인으로 취급하되, 실제 PDB 상에서는 ECL/상부 TM fragment로 구성.
- binder (Envafolimab, 체인 D) contig:
    - `D1-128` (VHH 전체 길이)
- 설계(inpaint) 대상 구간: Envafolimab CDR-H3
    - 체인 D, residue 98–117
    - 서열/구조 마스킹을 모두 적용하여 해당 구간을 새로 설계하도록 설정.
- hotspot residue (CCR8 ECL 상호작용 잔기):
    - 체인 C, residue 97, 106, 183, 283
    - 바인더가 이 부위와 상호작용하도록 유도.


### 4.3 실행에 사용한 명령

```bash
python external_tools/RFdiffusion/scripts/run_inference.py \\
  inference.input_pdb=data/reference/ccr8_ecl_envafolimab.pdb \\
  inference.num_designs=3 \\
  inference.output_prefix=data/processed/envaf_ccr8_cdr3 \\
  'contigmap.contigs=[C80-227/C237-265/C273-314/0 D1-128]' \\
  "ppi.hotspot_res=[C97,C106,C183,C283]" \\
  "contigmap.inpaint_seq=['D98','D99','D100','D101','D102','D103','D104','D105','D106','D107','D108','D109','D110','D111','D112','D113','D114','D115','D116','D117']" \\
  "contigmap.inpaint_str=['D98','D99','D100','D101','D102','D103','D104','D105','D106','D107','D108','D109','D110','D111','D112','D113','D114','D115','D116','D117']"
```


### 4.4 결과 요약

- 생성된 출력 파일:
    - `data/processed/envaf_ccr8_cdr3_*.pdb` (총 3개)
- 관찰 사항(시각적 검사 기준):
    - Envafolimab 체인 D 프레임워크(residue 1–97, 118–128)는 원형 구조를 유지.
    - CDR-H3 (D98–117)은 새로 설계된 서열·구조로 치환되며, CCR8 ECL 상부 포켓을 향해 돌출되는 형태를 보임(자세한 품질 평가는 후속 분석 필요).


## 5. 후속 계획 및 TODO

1. CDR-H3 형상 제약 강화
    - inpaint_str 옵션을 활용하여 CDR3 구간의 2차 구조(β-turn, loop 등) 패턴을 명시적으로 부여하는 조건 실험.
2. 포켓 내부 차폐(blocking) 강화
    - CCR8 ECL 포켓 내부 특정 잔기를 anchor로 선정하고, 해당 부위와의 접촉을 극대화하는 가이드 포텐셜 사용 검토.
3. 디자인 품질 평가
    - 각 디자인에 대해 (1) CCR8 접촉면적, (2) CDR3 packing, (3) 예상 developability(표면 전하, 히드로포빅 패치 등) 정량 평가 예정.
4. 재현성 확보
    - 동일 조건으로 seed 변경 실험 계획,
    - 본 문서에 seed, 랜덤 초기 조건 등 메타데이터 추가 기록 예정.

이런 형태로 보내라고

CCR8 나노바디–N말단 인터페이스 설계 및 개별미팅 기록
================================================

## 1. 실험/미팅 개요

- 일자: 2026-01-29
- 담당자: 윤현주
- 프로젝트: CCR8 상부(ECL 및 상부 TM)를 타겟으로 하는 de novo 나노바디 설계 + N-말단 기반 residence time 증강 전략 탐색[^1]
- 목적:
    - CCR8 리간드 결합 포켓 상부를 차폐(blocking)하는 나노바디를 설계하고,
    - Envafolimab 기반 CDR3 포켓-앵커 전략을 확장해,
    - 수용체 N-말단까지 활용해 residence time을 늘리는 “wrap-around형” GPCR 바인더 설계 방향을 수립.[^2][^1]


## 2. 사용 데이터 및 구조/논문 정보

### 2.1 CCR8 수용체

- 기본 참조 구조: PDB ID 8TLM (CCR8–Gi 복합체 구조), 체인 C.[^1]
- 사용 변형:
    - 솔러블 CCR8: 상부 ECL/TM을 안정화하기 위해 N-말단 및 일부 친수성 잔기에 변이가 도입된 soluble construct(외부 레퍼런스 구조 기반).[^1]
    - 와일드타입 CCR8: UniProt CCR8 서열 기준 AlphaFold 예측 구조 사용 권장(PDB 상 결손 residue 보완 목적).[^1]
- 현재 인식된 이슈:
    - 솔러블 CCR8 기반 설계에서는 RFdiffusion 결과에서 나노바디가 의도한 ECL 근처에 비교적 잘 배치됨.[^1]
    - 동일 나노바디를 와일드타입 CCR8 구조에 대입해 AlphaFold 복합체 예측 시, 나노바디가 ECL 대신 ICL/세포질 측에 붙는 모델이 반복적으로 생성됨(ipTM은 참고 수준).[^1]


### 2.2 Envafolimab VHH (나노바디) 관련 맥락

- 이전 날짜(2026-01-28) 실험:
    - Envafolimab VHH를 체인 D로 두고, IMGT 기준 CDR-H3(대략 D98–117)를 RFdiffusion inpaint 대상으로 설정.
    - CCR8 ECL-only 구조(체인 C)를 리셉터로 하고, CDR3가 ECL 상부 포켓을 향해 돌출되도록 설계하는 Envafolimab 기반 나노바디 디자인을 수행.[^3]
- 이번 미팅 피드백:
    - Envafolimab 프레임워크를 처음부터 고정할 필요는 없으며,
        - 1단계: de novo 프레임워크로 “잘 붙는” 나노바디를 먼저 만든 뒤,
        - 2단계: 필요 시 나중에 휴머나이제이션된 VHH 프레임워크로 교체하는 전략도 충분히 가능하다는 코멘트.[^1]


### 2.3 참고 논문: ACKR3–CXCL12 N-말단 역할

- 논문: Gustavsson et al., Sci. Signal. 2019 – “Kinetics of CXCL12 binding to atypical chemokine receptor 3 reveal a role for the receptor N terminus in chemokine binding.”[^2]
- 핵심 요약(미팅 중 강조된 부분):
    - 기존 two-site 모델: chemokine core가 먼저 수용체 N-말단(CRS1)에 붙고, chemokine N-말단이 포켓(CRS2)으로 들어간다고 가정.[^2]
    - 새 모델:

1) chemokine N-말단이 먼저 orthosteric pocket + ECL(CRS1.5/CRS2)과 상호작용을 형성.[^2]
2) 이후 수용체 N-말단이 chemokine을 둘러싸는 loop/wrap를 형성해 residence time을 늘리고 결합을 안정화.[^2][^1]
    - 수용체 N-말단의 역할은 “초기 docking site”가 아니라, 결합 후 복합체의 off-rate를 줄이고 안정성을 높이는 클램프 역할에 가깝다는 점을 kinetics로 제시.[^2]
    - chemokine의 residence time이 길수록 N-말단 절단/변이에 덜 민감하고, residence time이 짧을수록 더 민감해지는 패턴을 보여줌.[^2]


## 3. RFdiffusion 기반 CCR8 나노바디 설계 진행 상황

### 3.1 현재까지의 설정 및 관찰

- 리셉터:
    - CCR8 상부 ECL/TM (솔러블 CCR8 및 와일드타입 CCR8 구조 각각 사용).[^1]
- 바인더:
    - de novo VHH 또는 Envafolimab 기반 VHH, CDR3를 주요 설계 대상.[^1]
- 타겟 포켓:
    - ECL2–TM2/3 경계 부근의 상부 포켓을 “앵커링 포인트”로 설정.[^1]
- 첫 시도:
    - RFdiffusion로 ~10개 수준의 샘플 생성 후,
    - BioPython 스크립트로 “미리 지정한 패치와 CDR3 최소 거리(예: 6–8 Å)”를 기준으로 필터링.[^1]
- 관찰:
    - 솔러블 CCR8 기반에서는 일부 샘플에서 CDR3가 포켓/ECL 근처에 합리적으로 배치.[^1]
    - 와일드타입 CCR8 구조에서는 AlphaFold 복합체 예측 시 나노바디가 ICL/세포질 측에 반복적으로 붙는 문제 발생.[^1]
    - AlphaFold 복합체 예측의 절대 위치는 신뢰도가 낮다는 코멘트(“참고용으로만 보라”).[^1]


### 3.2 멀티-패치 앵커 전략 도입

- 문제 인식:
    - 포켓 내부로 CDR3가 들어갈 때 반대편에서 지지해 줄 상호작용이 부족해,
        - CDR3가 허공에 뜨거나,
        - 포켓을 비스듬히 스치듯 지나가며 안정적인 “앵커”를 형성하지 못함.[^1]
- 해결 방향(멀티-패치):
    - 패치 1: ECL2–TM2/3 경계 포켓 상부(주 앵커).[^1]
    - 패치 2: 포켓 반대편에 레버리지(지지) 패치 하나 추가.[^1]
    - 패치 3: ECL2를 양쪽에서 “압착(clamp)”하는 클램프 패치 추가.[^1]
    - → 총 2–3개 패치를 동시에 잡도록 RFdiffusion를 설정해, 나노바디가 포켓을 중심으로 보다 수평·안정적으로 앉도록 유도.[^1]
- 초기 결과:
    - ~20개 샘플 생성 결과, 일부 배치에서 5개 중 3–4개 정도가 타겟 패치 근처에 잘 붙는 모델이 나와, 멀티-패치 전략의 유효성을 확인.[^1]
    - 이 단계의 나노바디는 de novo 프레임워크 기반이며, 휴머나이제이션은 아직 적용하지 않은 상태.[^1]


## 4. N-말단 기반 residence time 설계 아이디어

### 4.1 논문 기반 해석 정리

- Gustavsson et al.로부터 얻은 핵심 인사이트:[^2][^1]
    - 수용체 N-말단은 초기 chemokine docking이 아니라,
        - chemokine N-말단이 포켓/ECL(CRS1.5/CRS2)에 먼저 자리잡은 이후,
        - 복합체의 off-rate를 줄이고 안정성을 높이는 “후속 클램프” 역할을 함.
    - 따라서 N-말단을 잘 활용하면 동일 KD라도 더 긴 residence time을 얻을 수 있음.


### 4.2 교수님 제안: 포켓 CDR3 + N-말단 인터페이스를 가진 나노바디

- 현재 설계 방향(요약):
    - CDR3가 CCR8 상부 포켓이나 ECL 근처에 박히도록 설계 중이며, 어디에 박히더라도 “상부에 잘 붙는” 바인더를 우선 확보하는 것이 1차 목표.[^1]
- 미팅에서 나온 제안(핵심 문장 요지):[^1]
    - “지금처럼 항체의 CDR가 포켓에 박히게 만들고,
        - 항체 프레임워크 영역 쪽에 수용체 N-말단이 붙을 수 있는 사이트를 새로 디자인해서,
        - Gustavsson 모델처럼 수용체 N-말단이 항체를 감싸며 residence time을 늘리는 구조를 모사해보면 어떻겠냐”라는 아이디어.
- 구체적인 설계 개념:
    - CDR3: CCR8 상부 포켓/ECL에 대한 primary 앵커(chemokine N-말단에 해당).
    - 나노바디의 프레임워크 또는 다른 CDR 면: CCR8 N-terminus 서열을 인식하는 secondary 인터페이스(수용체 N-말단 클램프 역할).[^1]
    - 최종적으로 “포켓 + N-말단” 2-인터페이스를 동시에 활용하는 wrap-around형 나노바디를 목표.


### 4.3 N-말단 펩타이드 활용 아이디어

- 교수님 코멘트 방향:[^1]
    - CCR8 N-terminus 서열을 알고 있으므로, 이 서열(또는 주요 모티프를 포함한 서브펩타이드)을 기반으로
        - 나노바디 프레임워크 위에 “N-말단 결합 사이트”를 인위적으로 만들 수 있음.
    - 초기에는 CCR8 N-말단 서열을 가진 synthetic 펩타이드를 epitope로 삼아,
        - RFdiffusion/역접힘 기반으로 “이 펩타이드에 잘 붙는 나노바디 면”을 설계한 뒤,
        - 실제 CCR8 N-말단에도 적용 가능한지 검증하는 접근을 제안.
- 목표:
    - 포켓에 박힌 CDR3 + 나노바디 프레임워크에 붙은 CCR8 N-말단이
→ 세포 표면에서 높은 residence time과 안정적인 결합을 제공하는 새로운 타입의 GPCR 바인더 구현.[^2][^1]


## 5. 앞으로의 방향 및 TODO

### 5.1 구조/입력 정리

- CCR8 구조 입력 재정리:[^1]
    - UniProt CCR8 서열 기준 AlphaFold 구조를 다운로드해, PDB 상 결손 residue 보완.
    - 솔러블 CCR8 vs 와일드타입 구조의 서열·구조 차이를 명시적으로 문서화.
    - RFdiffusion 입력 구조로는 “와일드타입에 가까운 상부 ECL/TM + 안정화 변이” 조합을 우선 사용하고, 사용한 구조 ID/버전을 기록.


### 5.2 RFdiffusion 설계 개선

- 샘플 수 확대:
    - 현재 ~10–20개 샘플 수준에서 → 최소 수십~수백 개 수준으로 확장하여 통계적 신뢰도 확보.[^1]
- 패치 전략:
    - ECL2–TM2/3 앵커 패치 + 레버리지 패치 + ECL2 클램프 패치 조합을 기본 세팅으로 사용.[^1]
    - 패치 위치·크기를 바꾼 여러 조건을 병렬로 실험하여, “앵커 + 지지 + 클램프” 구성이 잘 형성되는 조건을 탐색.
- 필터링 기준:
    - BioPython/파이썬 스크립트로
        - (1) 패치–CDR3 최소 거리,
        - (2) 접촉 면적,
        - (3) 포켓 방향성
을 기준으로 1차 후보 선별.[^1]
    - 이후 AlphaFold 복합체 예측(ipTM/PAE)을 참고하되, 결합 위치는 절대 기준이 아닌 보조 지표로 사용.[^1]


### 5.3 N-말단 펩타이드–바인딩 나노바디 설계

- 타깃 정의:
    - CCR8 N-terminus(예: 첫 20–30 aa)에서 chemokine–수용체 상호작용에 중요한 모티프를 포함하는 서브펩타이드 선택.[^4][^1]
- 설계 전략:
    - 선택된 N-말단 서브펩타이드를 epitope로 두고,
        - RFdiffusion epitope-conditioned 모드 또는 inverse folding 기반 툴(nanoFOLD 등)을 사용해,
        - 나노바디 프레임워크 한 면이 해당 펩타이드와 잘 결합하도록 CDR/표면을 설계.[^5][^6]
- 최종 목표:
    - “CDR3로 CCR8 상부 포켓을 잡고, 나노바디의 프레임워크/다른 면이 CCR8 N-말단을 붙잡아 wrap-around형 복합체를 형성”하는 2-인터페이스 바인더 후보군 도출.[^2][^1]


### 5.4 문서화 및 실험 연결

- 문서화:
    - 본 문서를 시작점으로,
        - (1) RFdiffusion 세부 파라미터,
        - (2) 샘플별 필터링 기준 및 점수,
        - (3) 후보 나노바디 리스트(서열, 구조, 점수)를 후속 labnote에 체계적으로 기록.
- 실험 연결:
    - de novo 프레임워크 기반 후보들 중 상위 디자인 몇 개를 선정해,
        - 별도의 휴머나이제이션 전략 검토 후,
        - 실제 발현·정제·세포 기반 바인딩 및 기능 실험으로 이어갈 수 있는 후보 세트 준비.

<div align="center">⁂</div>

[^1]: 260129-gaebyeolmiting.docx

[^2]: scisignal.aaw3657.pdf

[^3]: https://www.sciencedirect.com/science/article/pii/S016836592500954X

[^4]: https://www.nature.com/articles/s41467-023-43601-8

[^5]: https://labs.sciety.org/articles/by?article_doi=10.1101%2F2025.04.29.651236

[^6]: https://pmc.ncbi.nlm.nih.gov/articles/PMC10600234/

